<!DOCTYPE html>
<html>
<head>
  <title>IndiGo Flight Booking</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    
    h1 {
      text-align: center;
    }
    
    .container {
      width: 400px;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    
    .form-group {
      margin-bottom: 10px;
    }
    
    .form-group label {
      display: block;
      font-weight: bold;
    }
    
    .form-group input[type="text"], .form-group select {
      width: 100%;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    
    .form-group input[type="submit"] {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 5px;
      background-color: #007bff;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
    }
    
    .form-group input[type="submit"]:hover {
      background-color: #0056b3;
    }

    .search-container {
      width: 800px;
      margin: 0 auto;
      padding: 20px;
      display: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    th, td {
      padding: 10px;
      border: 1px solid #ccc;
    }
    
    th {
      background-color: #f9f9f9;
      font-weight: bold;
    }
    
    .price {
      font-weight: bold;
    }
    .save-button {
      padding: 5px 10px;
      border: none;
      border-radius: 5px;
      background-color: #007bff;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
    }
    
    .save-button:hover {
      background-color: #0056b3;
    }

  </style>
</head>
<body>
    <div class="container">
    <h1>IndiGo Flight Booking</h1>
    <form>
      <div class="form-group">
        <label for="from">From:</label>
        <select id="from" name="from" required>
          <option value="1">New Delhi</option>
          <option value="2">Mumbai</option>
          <option value="3">Bangalore</option>
          <option value="4">Kolkata</option>
          <option value="5">Chennai</option>
          <!-- Add more options as needed -->
        </select>
      </div>
      <div class="form-group">
        <label for="to">to:</label>
        <select id="to" name="to" required>
          <option value="1">New Delhi</option>
          <option value="2">Mumbai</option>
          <option value="3">Bangalore</option>
          <option value="4">Kolkata</option>
          <option value="5">Chennai</option>
          <!-- Add more options as needed -->
        </select>
      </div>
      <div class="form-group">
        <label for="departure_date">Departure Date:</label>
        <input type="date" id="departure_date" name="departure_date" required>
      </div>
      <div class="form-group">
        <label for="no_of_seats">Passengers:</label>
        <input id="no_of_seats" name="no_of_seats" type="text" required>        
      </div>
      <div class="form-group">
        <input type="submit" id="search-flights" value="Search Flights">
      </div>
    </form>
    </div> 
    <div id="search-container" class="search-container" name="search-container">
        <h1>Flight search results</h1>
    
            <table>
                <thead>
                    <tr>
                    <th>Flight No</th>
                    <th>Origin</th>
                    <th>Destination</th>
                    <th>Departure</th>
                    <th>Arrival</th>
                    <th>Price</th>
                    <th>Buy</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                    <td>IndigoAC32</td>
                    <td>New Delhi</td>
                    <td>Mumbai</td>
                    <td>2023-06-11</td>
                    <td>2023-06-11</td>
                    <td class="price">2340</td>
                    <td>
                        <button class="save-button">Save</button>
                    </td>
                    </tr>
                    <tr>
                        <td>IndigoAD23</td>
                        <td>New Delhi</td>
                        <td>Mumbai</td>
                        <td>2023-06-12</td>
                        <td>2023-06-12</td>
                        <td class="price">2000</td>
                        <td>
                            <button class="save-button">Save</button>
                        </td>
                    </tr>
                    <!-- Add more rows for additional flight results -->
                </tbody>
            </table>
     
    </div> 


    <!-- now showing the booking details -->
    <div class="booking-container">
        <h1>User Booking Details</h1>
        
        <table>
          <thead>
            <tr>
              <th>Booking ID</th>
              <th>Flight</th>
              <th>Origin</th>
              <th>Destination</th>
              <th>Departure</th>
              <th>Arrival</th>
              <th>Passengers</th>
            </tr>
          </thead>
          <tbody>
             <% bookings.forEach((booking) => { %>
            <tr>
              <td><%= booking._id %></td>
              <td><%= booking.flight_no %></td>
              <td><%= booking.from  %></td>
              <td><%= booking.to %></td>
              <td><%= booking.departure_date %></td>
              <td><%= booking.arrival_date %></td>
              <td><%= booking.no_of_seats %></td>
            </tr>
            <% }) %>
       
            <!-- <tr>
              <td>Booking 001</td>
              <td>IndigoAC32</td>
              <td>New Delhi</td>
              <td>Mumbai</td>
              <td>2023-06-12</td>
              <td>2023-06-12</td>
              <td>2</td>
            </tr>
            <tr>
              <td>IndigoAD23</td>
                <td>New Delhi</td>
                <td>Mumbai</td>
                <td>2023-06-12</td>
                <td>2023-06-12</td>
                
              <td>1</td>
            </tr> -->
            <!-- Add more rows for additional booking details -->
          </tbody>
        </table>
    </div>
        
    



    
    
</body>

<!-- adding the jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    // Add your client-side JavaScript code here when click on it
    //now we going to show the search-container
    document.getElementById("search-flights").addEventListener("click",function(){
        document.getElementById("search-container").style.display = "block"; 
    });


    $(document).ready(function() {
      $('.save-button').on('click', function() {
        console.log("save button clicked")
        // Get the row data
        const flight = $(this).closest('tr').find('.flight').text();
        const origin = $(this).closest('tr').find('.origin').text();
        const destination = $(this).closest('tr').find('.destination').text();
        const departure = $(this).closest('tr').find('.departure').text();
        const arrival = $(this).closest('tr').find('.arrival').text();
        const passengers = parseInt($(this).closest('tr').find('.passengers').text(), 10);

        // Create an object with the row data
        const rowData = {
          bookingId,
          flight,
          origin,
          destination,
          departure,
          arrival,
          passengers
        };

        // Send an AJAX POST request to the API endpoint
        $.ajax({
          url: '/indigo/book',
          type: 'POST',
          contentType: 'application/json',
            data: JSON.stringify(rowData),
            success: function(response) {
              // Do something with the response
              console.log(response);
            },
            error: function(error) {
              // Do something with the error
              console.log(error);
            }
        });

    });
        
    });





</script>
</html>
